apiVersion: v1
kind: Service
metadata:
  name: {{ .Release.Name }}-svc-api
  namespace: application-tech-challenge
  annotations:
    service.beta.kubernetes.io/aws-load-balancer-backend-protocol: tcp
    service.beta.kubernetes.io/aws-load-balancer-cross-zone-load-balancing-enabled: "true"
    service.beta.kubernetes.io/aws-load-balancer-type: "external"
    service.beta.kubernetes.io/aws-load-balancer-nlb-target-type: "instance"
    service.beta.kubernetes.io/aws-load-balancer-scheme: "internet-facing"
  labels:
    app: {{ .Release.Name }}-svc-api
spec:
  selector:
    app: {{ .Release.Name }}-api-deployment
  type: {{ .Values.application.service.type }}
  ports:
    - port: {{ .Values.application.service.ports.port }}
      protocol: {{ .Values.application.service.ports.protocol }}
      targetPort: {{ .Values.application.port.default }}
